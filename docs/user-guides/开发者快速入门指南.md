# AI Hub 开发者快速入门指南

欢迎使用 AI Hub！本指南将帮助您在几分钟内开始使用我们的 AI API。

## 准备工作

- AI Hub 账户（在 [aihub.com](https://aihub.com) 注册）
- 您偏好的编程语言
- 文本编辑器或 IDE

## 第一步：获取您的 API 密钥

1. 在 [AI Hub 开发者门户](https://aihub.com/developers) **注册账户**
2. 在仪表板中 **导航到 API 密钥** 部分
3. **创建新的 API 密钥**：
   - 给它一个描述性名称（例如："我的第一个应用"）
   - 选择权限：`chat`、`usage`
   - 点击"创建 API 密钥"
4. **复制您的 API 密钥** - 它以 `sk_aihub_` 开头

⚠️ **重要提示**：请确保您的 API 密钥安全，永远不要在客户端代码或公共仓库中暴露它。

## 第二步：选择集成方法

### 选项 A：直接 API 调用（推荐用于测试）

### 选项 B：使用我们的 SDK（推荐用于生产环境）

我们为 Python、JavaScript 等语言提供官方 SDK。

## 第三步：进行第一次 API 调用

### Python 示例

```python
# 安装 AI Hub Python SDK
pip install aihub-client

# 创建名为 test_aihub.py 的文件
import asyncio
from aihub import AIHubClient

async def main():
    # 初始化客户端
    client = AIHubClient(api_key="sk_aihub_您的api密钥")

    # 发起简单的聊天请求
    try:
        response = await client.chat.completions.create(
            message="你好！你能解释一下你能做什么吗？",
            model="gpt-4o-mini"  # 免费模型用于测试
        )

        print("AI 回复：", response.content)
        print("使用的 tokens：", response.usage.total_tokens)
        print("费用：", f"${response.usage.estimated_cost:.4f}")

    except Exception as e:
        print(f"错误：{e}")

if __name__ == "__main__":
    asyncio.run(main())
```

**运行它**：
```bash
python test_aihub.py
```

### JavaScript/Node.js 示例

```javascript
// 安装 AI Hub JavaScript SDK
npm install @aihub/client

// 创建名为 test_aihub.js 的文件
import { AIHubClient } from '@aihub/client';

async function main() {
    // 初始化客户端
    const client = new AIHubClient('sk_aihub_您的api密钥');

    try {
        // 发起简单的聊天请求
        const response = await client.chat.completions.create({
            message: '你好！你能解释一下你能做什么吗？',
            model: 'gpt-4o-mini'  // 免费模型用于测试
        });

        console.log('AI 回复：', response.content);
        console.log('使用的 tokens：', response.usage.totalTokens);
        console.log('费用：', `$${response.usage.estimatedCost.toFixed(4)}`);

    } catch (error) {
        console.error('错误：', error.message);
    }
}

main();
```

**运行它**：
```bash
node test_aihub.js
```

### cURL 示例（用于测试）

```bash
curl -X POST "http://localhost:8001/api/v1/chat/completions" \
  -H "Authorization: Bearer sk_aihub_您的api密钥" \
  -H "Content-Type: application/json" \
  -d '{
    "message": "你好！你能解释一下你能做什么吗？",
    "model": "gpt-4o-mini"
  }'
```

## 第四步：尝试流式响应

为了更好的用户体验，对较长的响应使用流式传输：

### Python 流式示例

```python
import asyncio
from aihub import AIHubClient

async def main():
    client = AIHubClient(api_key="sk_aihub_您的api密钥")

    print("AI：", end="", flush=True)

    # 流式获取响应
    async for chunk in client.chat.completions.stream(
        message="写一首关于编程的短诗",
        model="gpt-4o-mini"
    ):
        print(chunk.content, end="", flush=True)

    print()  # 换行

asyncio.run(main())
```

### JavaScript 流式示例

```javascript
import { AIHubClient } from '@aihub/client';

async function main() {
    const client = new AIHubClient('sk_aihub_您的api密钥');

    process.stdout.write('AI：');

    // 流式获取响应
    const stream = await client.chat.completions.stream({
        message: '写一首关于编程的短诗',
        model: 'gpt-4o-mini'
    });

    for await (const chunk of stream) {
        process.stdout.write(chunk.content);
    }

    console.log(); // 换行
}

main();
```

## 第五步：使用会话管理对话

在多个消息之间保持对话上下文：

```python
import asyncio
from aihub import AIHubClient

async def main():
    client = AIHubClient(api_key="sk_aihub_您的api密钥")

    # 创建新会话
    session = await client.sessions.create(
        title="AI 助手对话",
        model="gpt-4o-mini"
    )

    print(f"会话已创建：{session.session_id}")

    # 在会话中发送消息
    messages = [
        "你好，我正在学习 AI。你能帮助我吗？",
        "机器学习的主要类型有哪些？",
        "你能给我一个监督学习的简单例子吗？"
    ]

    for message in messages:
        response = await client.chat.completions.create(
            message=message,
            session_id=session.session_id,
            model="gpt-4o-mini"
        )

        print(f"\n用户：{message}")
        print(f"AI：{response.content}")

    # 获取会话历史
    history = await client.sessions.get(session.session_id)
    print(f"\n会话中的总消息数：{history.message_count}")

asyncio.run(main())
```

## 第六步：监控您的使用情况

跟踪您的 API 使用情况和费用：

```python
import asyncio
from aihub import AIHubClient

async def main():
    client = AIHubClient(api_key="sk_aihub_您的api密钥")

    # 获取过去 7 天的使用概览
    usage = await client.usage.overview(days=7)

    print(f"使用情况摘要（过去 7 天）：")
    print(f"总请求数：{usage.total_requests}")
    print(f"总 tokens 数：{usage.total_tokens:,}")
    print(f"总费用：${usage.total_cost:.2f}")
    print(f"平均每次请求费用：${usage.total_cost/usage.total_requests:.4f}")

    # 获取详细分析
    analytics = await client.usage.analytics(days=7)

    print(f"\n最常用的模型：")
    for model in analytics.top_models[:3]:
        print(f"- {model.model}：{model.requests} 次请求")

asyncio.run(main())
```

## 下一步

### 1. 探索可用模型

```python
# 列出所有可用模型
models = await client.models.list()
for model in models:
    print(f"{model.id}：{model.name} - ${model.pricing.input}/1K tokens")
```

### 2. 构建简单的聊天应用

这里是一个使用 Python 和 Flask 的最小聊天应用：

```python
# app.py
from flask import Flask, render_template, request, jsonify
import asyncio
from aihub import AIHubClient

app = Flask(__name__)
client = AIHubClient(api_key="sk_aihub_您的api密钥")

@app.route('/')
def home():
    return render_template('index.html')

@app.route('/chat', methods=['POST'])
def chat():
    data = request.json
    message = data.get('message')

    try:
        response = asyncio.run(client.chat.completions.create(
            message=message,
            model="gpt-4o-mini"
        ))

        return jsonify({
            'success': True,
            'response': response.content
        })
    except Exception as e:
        return jsonify({
            'success': False,
            'error': str(e)
        })

if __name__ == '__main__':
    app.run(debug=True)
```

```html
<!-- templates/index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>AI 聊天演示</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .chat-container { border: 1px solid #ddd; padding: 20px; height: 400px; overflow-y: auto; margin-bottom: 20px; }
        .message { margin-bottom: 10px; padding: 10px; border-radius: 5px; }
        .user { background-color: #e3f2fd; }
        .ai { background-color: #f3e5f5; }
        input { width: 70%; padding: 10px; }
        button { width: 25%; padding: 10px; }
    </style>
</head>
<body>
    <h1>AI 聊天演示</h1>
    <div id="chat" class="chat-container"></div>
    <div>
        <input type="text" id="messageInput" placeholder="输入您的消息..." />
        <button onclick="sendMessage()">发送</button>
    </div>

    <script>
        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();

            if (!message) return;

            const chatContainer = document.getElementById('chat');

            // 添加用户消息
            chatContainer.innerHTML += `<div class="message user">您：${message}</div>`;
            input.value = '';

            try {
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: message })
                });

                const data = await response.json();

                if (data.success) {
                    chatContainer.innerHTML += `<div class="message ai">AI：${data.response}</div>`;
                } else {
                    chatContainer.innerHTML += `<div class="message ai">错误：${data.error}</div>`;
                }
            } catch (error) {
                chatContainer.innerHTML += `<div class="message ai">错误：${error.message}</div>`;
            }

            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        document.getElementById('messageInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
    </script>
</body>
</html>
```

**运行聊天应用**：
```bash
pip install flask
python app.py
```

访问 `http://localhost:5000` 查看您的聊天应用！

## 常见用例

### 1. 内容生成

```python
# 生成博客文章、文章或营销文案
response = await client.chat.completions.create(
    message="写一篇关于 AI 在医疗保健领域益处的 500 字博客文章",
    model="gpt-4o",
    max_tokens=800,
    temperature=0.7
)
```

### 2. 代码生成和辅助

```python
# 生成代码示例或获取编程帮助
response = await client.chat.completions.create(
    message="写一个使用正则表达式验证电子邮件地址的 Python 函数",
    model="gpt-4o"  # 更适合代码生成
)
```

### 3. 数据分析

```python
# 分析和解释数据
response = await client.chat.completions.create(
    message="分析这个销售数据并提供见解：[您的数据在这里]",
    model="gpt-4o"
)
```

### 4. 客户支持

```python
# 构建客户支持机器人
response = await client.chat.completions.create(
    message=f"客户问题：{customer_question}\n提供有用的回复：",
    model="gpt-4o-mini",  # 对支持服务更具成本效益
    temperature=0.3  # 更一致的回复
)
```

## 最佳实践

### 1. 成本管理

- 对开发和简单任务使用 `gpt-4o-mini`
- 设置 `max_tokens` 来限制响应长度
- 定期监控您的使用情况
- 对更好的用户体验使用流式传输

### 2. 错误处理

```python
import asyncio
from aihub import AIHubClient
from aihub.exceptions import APIError, RateLimitError

async def safe_chat_request(message, max_retries=3):
    client = AIHubClient(api_key="sk_aihub_您的api密钥")

    for attempt in range(max_retries):
        try:
            return await client.chat.completions.create(
                message=message,
                model="gpt-4o-mini"
            )
        except RateLimitError:
            if attempt < max_retries - 1:
                wait_time = 2 ** attempt  # 指数退避
                print(f"达到速率限制。等待 {wait_time} 秒...")
                await asyncio.sleep(wait_time)
                continue
            raise
        except APIError as e:
            print(f"API 错误：{e.message}")
            raise

# 使用
try:
    response = await safe_chat_request("你好！")
    print(response.content)
except Exception as e:
    print(f"重试后失败：{e}")
```

### 3. 输入验证

```python
def validate_message(message):
    if not message or not message.strip():
        raise ValueError("消息不能为空")

    if len(message) > 10000:
        raise ValueError("消息太长（最多 10,000 字符）")

    return message.strip()

# 使用
try:
    clean_message = validate_message(user_input)
    response = await client.chat.completions.create(message=clean_message)
except ValueError as e:
    print(f"验证错误：{e}")
```

## 获取帮助

- **文档**：https://docs.aihub.com
- **API 参考**：https://api.aihub.com/docs
- **社区论坛**：https://community.aihub.com
- **支持**：support@aihub.com
- **状态页面**：https://status.aihub.com

## 接下来做什么？

恭喜！您已成功将 AI Hub 集成到您的应用程序中。以下是一些可以探索的内容：

1. **高级功能**：批处理、函数调用、图像生成
2. **优化**：缓存、连接池、批量请求
3. **生产部署**：环境变量、错误监控、日志记录
4. **扩展**：速率限制、负载均衡、监控

编码愉快！🚀