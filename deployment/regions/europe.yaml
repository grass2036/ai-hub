# 欧洲区域部署配置
# Europe Regional Deployment Configuration

region:
  name: "europe"
  display_name: "Europe"
  code: "eu"

# 数据中心配置
datacenters:
  # 主要数据中心 - 法兰克福
  primary:
    name: "Frankfurt"
    code: "de-fra-1"
    location: "Frankfurt, Germany"
    provider: "AWS"
    region: "eu-central-1"
    availability_zones: ["eu-central-1a", "eu-central-1b", "eu-central-1c"]

  # 次要数据中心 - 爱尔兰
  secondary:
    name: "Ireland"
    code: "ie-dub-1"
    location: "Dublin, Ireland"
    provider: "AWS"
    region: "eu-west-1"
    availability_zones: ["eu-west-1a", "eu-west-1b", "eu-west-1c"]

  # 边缘数据中心 - 伦敦
  edge:
    name: "London"
    code: "uk-lon-1"
    location: "London, United Kingdom"
    provider: "AWS"
    region: "eu-west-2"
    availability_zones: ["eu-west-2a", "eu-west-2b"]

# 网络配置
networking:
  cdn:
    provider: "Cloudflare"
    distribution_types:
      - "static"    # 静态资源CDN
      - "api"       # API请求CDN
      - "streaming" # 实时流媒体CDN

  load_balancer:
    type: "Application Load Balancer"
    algorithm: "round_robin"
    health_check:
      path: "/health"
      interval: 30
      timeout: 5
      healthy_threshold: 2
      unhealthy_threshold: 3

  dns:
    provider: "Route53"
    routing_policy: "geolocation"
    records:
      - type: "A"
        ttl: 60
        geo_location: "Europe"

# 数据库配置
database:
  primary:
    engine: "PostgreSQL"
    version: "15.4"
    instance_class: "db.r6g.2xlarge"
    multi_az: true
    storage_type: "io1"
    allocated_storage: 1000
    iops: 20000
    backup_retention: 30
    backup_window: "02:00-03:00"
    maintenance_window: "sun:03:00-sun:04:00"

  read_replicas:
    - region: "eu-central-1"
      instance_class: "db.r6g.xlarge"
    - region: "eu-west-1"
      instance_class: "db.r6g.xlarge"

  cache:
    engine: "Redis"
    version: "7.0"
    node_type: "cache.r6g.2xlarge"
    cluster_mode: true
    num_cache_nodes: 3
    automatic_failover: true

# 容器编排
kubernetes:
  version: "1.28"
  node_groups:
    - name: "system"
      instance_types: ["m6g.large", "m6g.xlarge"]
      min_size: 2
      max_size: 5
      desired_size: 3
      disk_size: 50

    - name: "application"
      instance_types: ["c6g.2xlarge", "c6g.4xlarge"]
      min_size: 3
      max_size: 10
      desired_size: 5
      disk_size: 100

    - name: "batch"
      instance_types: ["r6g.4xlarge", "r6g.8xlarge"]
      min_size: 1
      max_size: 5
      desired_size: 2
      disk_size: 200

# 监控和日志
monitoring:
  metrics:
    prometheus:
      retention: "30d"
      scrape_interval: "15s"

  logs:
    elasticsearch:
      retention: "90d"
      shard_count: 6
      replica_count: 1

  tracing:
    jaeger:
      retention: "7d"
      sampling_rate: 0.1

# 安全配置
security:
  ssl_certificates:
    provider: "AWS Certificate Manager"
    certificate_arn: "arn:aws:acm:eu-central-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"

  waf:
    provider: "AWS WAF"
    rules:
      - name: "SQLInjection"
        action: "block"
      - name: "XSS"
        action: "block"
      - name: "RateLimit"
        action: "throttle"
        rate_limit: 1000

  network_security:
    vpc_cidr: "10.1.0.0/16"
    public_subnets: ["10.1.1.0/24", "10.1.2.0/24"]
    private_subnets: ["10.1.11.0/24", "10.1.12.0/24"]
    database_subnets: ["10.1.21.0/24", "10.1.22.0/24"]

# 数据合规性 (重点: GDPR)
compliance:
  data_residency: "local"
  encryption_at_rest: true
  encryption_in_transit: true
  audit_logging: true

  gdpr_compliance:
    enabled: true
    data_protection_officer: "dpo@ai-hub.com"
    data_processing_agreement: true
    consent_management: true
    right_to_access: true
    right_to_erasure: true
    right_to_portability: true
    right_to_object: true
    breach_notification: "72h"
    privacy_by_design: true
    privacy_by_default: true

  local_regulations:
    - country: "Germany"
      acts: ["Bundesdatenschutzgesetz (BDSG)", "GDPR"]
      data_residency: true
      consent_required: true
      data_officer: true

    - country: "France"
      acts: ["Loi Informatique et Libertés", "GDPR"]
      data_residency: true
      consent_required: true
      data_officer: true

    - country: "Ireland"
      acts: ["Data Protection Act", "GDPR"]
      data_residency: true
      consent_required: true
      data_officer: true

    - country: "United Kingdom"
      acts: ["Data Protection Act 2018", "UK GDPR"]
      data_residency: true
      consent_required: true
      data_officer: true

# 自动扩展
auto_scaling:
  web_servers:
    min_capacity: 3
    max_capacity: 20
    target_cpu_utilization: 60
    target_memory_utilization: 70
    scale_up_cooldown: 300
    scale_down_cooldown: 300

  api_servers:
    min_capacity: 2
    max_capacity: 15
    target_cpu_utilization: 50
    target_memory_utilization: 65
    scale_up_cooldown: 180
    scale_down_cooldown: 300

# 备份和灾难恢复
backup:
  automated_backups:
    - service: "database"
      schedule: "0 2 * * *"  # 每天凌晨2点
      retention_days: 90
      cross_region: true
      cross_region_replication: "eu-west-1"

    - service: "file_storage"
      schedule: "0 1 * * 0"  # 每周日凌晨1点
      retention_days: 180
      cross_region: true
      cross_region_replication: "eu-west-1"

  disaster_recovery:
    rto: "2h"  # Recovery Time Objective (更严格)
    rpo: "15m"  # Recovery Point Objective (更严格)
    failover: "automatic"
    testing_frequency: "quarterly"