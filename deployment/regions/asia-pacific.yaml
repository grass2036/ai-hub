# 亚太区域部署配置
# Asia-Pacific Regional Deployment Configuration

region:
  name: "asia-pacific"
  display_name: "Asia Pacific"
  code: "apac"

# 数据中心配置
datacenters:
  # 主要数据中心 - 新加坡
  primary:
    name: "Singapore"
    code: "sg-sin-1"
    location: "Singapore"
    provider: "AWS"
    region: "ap-southeast-1"
    availability_zones: ["ap-southeast-1a", "ap-southeast-1b", "ap-southeast-1c"]

  # 次要数据中心 - 东京
  secondary:
    name: "Tokyo"
    code: "jp-tok-1"
    location: "Tokyo, Japan"
    provider: "AWS"
    region: "ap-northeast-1"
    availability_zones: ["ap-northeast-1a", "ap-northeast-1b", "ap-northeast-1c"]

  # 边缘数据中心 - 首尔
  edge:
    name: "Seoul"
    code: "kr-sel-1"
    location: "Seoul, South Korea"
    provider: "AWS"
    region: "ap-northeast-2"
    availability_zones: ["ap-northeast-2a", "ap-northeast-2b"]

# 网络配置
networking:
  cdn:
    provider: "Cloudflare"
    distribution_types:
      - "static"    # 静态资源CDN
      - "api"       # API请求CDN
      - "streaming" # 实时流媒体CDN

  load_balancer:
    type: "Application Load Balancer"
    algorithm: "round_robin"
    health_check:
      path: "/health"
      interval: 30
      timeout: 5
      healthy_threshold: 2
      unhealthy_threshold: 3

  dns:
    provider: "Route53"
    routing_policy: "geolocation"
    records:
      - type: "A"
        ttl: 60
        geo_location: "Asia-Pacific"

# 数据库配置
database:
  primary:
    engine: "PostgreSQL"
    version: "15.4"
    instance_class: "db.r6g.2xlarge"
    multi_az: true
    storage_type: "io1"
    allocated_storage: 1000
    iops: 20000
    backup_retention: 7
    backup_window: "03:00-04:00"
    maintenance_window: "sun:04:00-sun:05:00"

  read_replicas:
    - region: "ap-southeast-1"
      instance_class: "db.r6g.xlarge"
    - region: "ap-northeast-1"
      instance_class: "db.r6g.xlarge"

  cache:
    engine: "Redis"
    version: "7.0"
    node_type: "cache.r6g.2xlarge"
    cluster_mode: true
    num_cache_nodes: 3
    automatic_failover: true

# 容器编排
kubernetes:
  version: "1.28"
  node_groups:
    - name: "system"
      instance_types: ["m6g.large", "m6g.xlarge"]
      min_size: 2
      max_size: 5
      desired_size: 3
      disk_size: 50

    - name: "application"
      instance_types: ["c6g.2xlarge", "c6g.4xlarge"]
      min_size: 3
      max_size: 10
      desired_size: 5
      disk_size: 100

    - name: "batch"
      instance_types: ["r6g.4xlarge", "r6g.8xlarge"]
      min_size: 1
      max_size: 5
      desired_size: 2
      disk_size: 200

# 监控和日志
monitoring:
  metrics:
    prometheus:
      retention: "30d"
      scrape_interval: "15s"

  logs:
    elasticsearch:
      retention: "90d"
      shard_count: 6
      replica_count: 1

  tracing:
    jaeger:
      retention: "7d"
      sampling_rate: 0.1

# 安全配置
security:
  ssl_certificates:
    provider: "AWS Certificate Manager"
    certificate_arn: "arn:aws:acm:ap-southeast-1:123456789012:certificate/12345678-1234-1234-1234-123456789012"

  waf:
    provider: "AWS WAF"
    rules:
      - name: "SQLInjection"
        action: "block"
      - name: "XSS"
        action: "block"
      - name: "RateLimit"
        action: "throttle"
        rate_limit: 1000

  network_security:
    vpc_cidr: "10.0.0.0/16"
    public_subnets: ["10.0.1.0/24", "10.0.2.0/24"]
    private_subnets: ["10.0.11.0/24", "10.0.12.0/24"]
    database_subnets: ["10.0.21.0/24", "10.0.22.0/24"]

# 数据合规性
compliance:
  data_residency: "local"
  encryption_at_rest: true
  encryption_in_transit: true
  audit_logging: true

  local_regulations:
    - country: "Singapore"
      acts: ["Personal Data Protection Act (PDPA)"]
      data_residency: true
      consent_required: true

    - country: "Japan"
      acts: ["Act on the Protection of Personal Information (APPI)"]
      data_residency: true
      consent_required: true

    - country: "South Korea"
      acts: ["Personal Information Protection Act (PIPA)"]
      data_residency: true
      consent_required: true

# 自动扩展
auto_scaling:
  web_servers:
    min_capacity: 3
    max_capacity: 20
    target_cpu_utilization: 60
    target_memory_utilization: 70
    scale_up_cooldown: 300
    scale_down_cooldown: 300

  api_servers:
    min_capacity: 2
    max_capacity: 15
    target_cpu_utilization: 50
    target_memory_utilization: 65
    scale_up_cooldown: 180
    scale_down_cooldown: 300

# 备份和灾难恢复
backup:
  automated_backups:
    - service: "database"
      schedule: "0 3 * * *"  # 每天凌晨3点
      retention_days: 30
      cross_region: true
      cross_region_replication: "ap-northeast-1"

    - service: "file_storage"
      schedule: "0 2 * * 0"  # 每周日凌晨2点
      retention_days: 90
      cross_region: true
      cross_region_replication: "ap-northeast-1"

  disaster_recovery:
    rto: "4h"  # Recovery Time Objective
    rpo: "1h"  # Recovery Point Objective
    failover: "automatic"
    testing_frequency: "monthly"